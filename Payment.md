# Basic requirements
## Interfaces
- API
  - Взаимодействие Мерчанта и GATE
    - Платеж (одностадийный и двухстадийный)
    - Рекуррентный платеж
    - Возврат
    - Выплата
    - Корректировки
    - Перевод
  - Операции с чувствительными данными платежных инструментов (прием
зашифрованных карточных данных)
    - токенизация платежного инструмента
    - взаимодействие с Binbase
    - взаимодействие с token adapters
- Payment form – пользовательский интерфейс для ввода платежных данных и
автоматизации проведения платежа через вызов методов внешнего API
## Сore
- Protocol
  - Обеспечивает бизнес-логику проведения транзакций (не хранит данные,
зависит от Object model и State machines), а также обеспечивает
взаимодействие с Адаптерами и Антифрод системой.
  - Обеспечивает идемпотентность внешних вызовов API и возможность
использования стороннего идентификатора транзакции, определенного
Мерчантом.
  - Обеспечивает создание и изменение основных объектов системы.
GATE High-level design old 3
Object model
Хранение основных объектов системы: мерчант, терминал магазина,
провайдер, шлюз провайдера, правило роутинга, лимит, разрешения
мерчанта, ограничения провайдера.
Интеграция с Core Bank
Синхронизация объектов с Core Bank.
Получение тарифов по Мерчанту и шлюзу Провайдера.
Настройка правил роутинга – выбор Шлюза провайдера для транзакций по
определенным Мерчантам, в зависимости от типа Платежного
инструмента, необходимо обеспечить возможность балансировки трафика
между шлюзами и определение очереди шлюзов для каскадирования
транзакций.
Установка лимитов на проведение определенных транзакций по шлюзам
Провайдера или по Мерчантам на определенный период.
Вспомогательные сервисы
IP base – обеспечивает определение информации о стране
Плательщика.
Provider Tester – обеспечивает проверку доступности внешних
провайдеров, выполняет тестовые запросы на endpoints провайдеров.
State machines – предоставляет состояние транзакции по запросу, сохраняет
изменение состояния транзакции.
Transactions – формирует и сохраняет проводки на счета Мерчантов, сервис
необходим для реализации сплитования.
Base – основная распределенная СУБД, хранит информацию о событиях
системы, осуществляет репликацию данных через брокер событий.
High-security zone
Binbase – обеспечивает определение информации о стране, банке-эмитенте,
типе платёжной карты и предоставляет информацию для маршрутизации
GATE High-level design old 4
платежного потока в зависимости от указанных данных.
Card data storage – обеспечивает расшифровку и зашифрованное хранение
чувствительных данных, поддерживает автоматический контроль затирания
CVV после проведения платежа, обеспечивает перешифровку данных с
определенной периодичностью и обновление карточных данных по запросу.
Token adapters – адаптеры для интеграции с провайдерами токенизации
(applepay, googlepay, samsungpay).
Provider adapters – адаптеры для интеграции с провайдерами,
обеспечивающими проведение транзакций (банками эквайерами или другими
платежными шлюзами).
MPI adapters – адаптеры для интеграции с MPI провайдерами,
обеспечивающими проведение 3DS.
Other services
Notificator – обеспечивает Мерчантам рассылку асинхронных коллбеков,
сервис подписан на определенные события в Kafka.
Tester – запускает тестовые транзакции в GATE с определенной
периодичность. Создает транзакций разных типов и имитирует
взаимодействие с провайдером.
Kafka – брокер событий, предоставляет возможность подписаться и получить
определенные типы событий ядра GATE.
ELK – обеспечивает хранение и чтение Log base всех микросервисов GATE.
Antifraud – Выдает score Платежного инструмента по Транзакции
Создание черных, белых списков
Создание лимитов на определенный тип Транзакций и/или Платежный
инструмент для Мерчанта или Терминала
Настройка нотификаций
Интерфейс для конфигурирования Antifraud
