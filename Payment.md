# Basic requirements
## Interfaces
- API
  - Взаимодействие Продавца и Payment System
    - Платеж (одностадийный и двухстадийный)
    - Рекуррентный платеж
    - Возврат
    - Выплата
    - Корректировки
    - Перевод
## Сore
- Protocol
  - Обеспечивает бизнес-логику проведения транзакций (не хранит данные, зависит от Object model и State machines), а также обеспечивает взаимодействие с Адаптерами и Антифрод системой.
  - Обеспечивает идемпотентность внешних вызовов API и возможность использования стороннего идентификатора транзакции, определенного Продавца.
  - Обеспечивает создание и изменение основных объектов системы.
- Object model
  - Хранение основных объектов системы: мерчант, терминал магазина, провайдер, шлюз провайдера, правило роутинга, лимит, разрешения Продавца, ограничения провайдера.
- Интеграция с Core Bank
  - Синхронизация объектов с АБС компании.
  - Получение тарифов по Мерчанту и шлюзу Провайдера.
  - Настройка правил роутинга – выбор Шлюза провайдера для транзакций по определенным Продавцам, в зависимости от типа Платежного инструмента, необходимо обеспечить возможность балансировки трафика между шлюзами и определение очереди шлюзов для каскадирования
транзакций.
  - Установка лимитов на проведение определенных транзакций по шлюзам Провайдерам или по Продавцам на определенный период.
  - Вспомогательные сервисы
    - IP base – обеспечивает определение информации о стране
Плательщика.
    - Provider Tester – обеспечивает проверку доступности внешних провайдеров, выполняет тестовые запросы на endpoints провайдеров.
    - State machines – предоставляет состояние транзакции по запросу, сохраняет изменение состояния транзакции.
    - Transactions – формирует и сохраняет проводки на счета Мерчантов, сервис необходим для реализации сплитования.
    - Base – основная распределенная СУБД, хранит информацию о событиях системы, осуществляет репликацию данных через брокер событий.
    - Adapters – адаптеры для интеграции с провайдерами, обеспечивающими проведение транзакций (банками эквайерами или другими
платежными шлюзами).
## Other services
- Notificator – обеспечивает Продавцам рассылку асинхронных коллбеков,
сервис подписан на определенные события в Kafka.
- Tester – запускает тестовые транзакции в Payment System с определенной
периодичность. Создает транзакций разных типов и имитирует
взаимодействие с провайдером.
- Kafka – брокер событий, предоставляет возможность подписаться и получить
определенные типы событий ядра Payment System.
- ELK – обеспечивает хранение и чтение Log base всех микросервисов Payment System.
- Antifraud – Выдает score Платежного инструмента по Транзакции
  - Создание черных, белых списков
  - Создание лимитов на определенный тип Транзакций и/или Платежный инструмент для Продавца или Терминала
  - Настройка нотификаций
  - Интерфейс для конфигурирования Antifraud
